name: 🏋️ 필라테스 자동 예약 v3.1

on:
  schedule:
    # 한국시간 매일 00:00 (UTC 15:00)
    # 정각에 실행하되, 주말은 스크립트에서 자동 스킵
    - cron: '0 15 * * *'  # 정확히 자정에 실행하도록 수정
  
  workflow_dispatch:
    inputs:
      test_mode:
        description: '테스트 모드 (실제 예약하지 않음)'
        required: false
        default: 'false'
        type: choice
        options:
          - 'true'
          - 'false'
      force_weekend:
        description: '주말에도 강제 실행 (테스트용)'
        required: false
        default: 'false'
        type: choice
        options:
          - 'true'
          - 'false'

jobs:
  check-weekday:
    runs-on: ubuntu-latest
    outputs:
      should_run: ${{ steps.check.outputs.should_run }}
      target_date: ${{ steps.check.outputs.target_date }}
      day_name: ${{ steps.check.outputs.day_name }}
    steps:
    - name: 📅 주말 체크 (KST 기준) - 수정됨
      id: check
      run: |
        # 현재 UTC 시간을 KST로 변환하여 7일 후 계산
        echo "현재 UTC: $(date -u)"
        
        # KST 기준 현재 시간 (UTC + 9시간)
        current_kst=$(TZ='Asia/Seoul' date)
        echo "현재 KST: $current_kst"
        
        # KST 기준 현재 요일 확인
        current_day=$(TZ='Asia/Seoul' date '+%u')
        current_day_name=$(TZ='Asia/Seoul' date '+%A')
        echo "현재 요일: $current_day_name (숫자: $current_day)"
        
        # KST 기준 7일 후 날짜 계산
        target_date=$(TZ='Asia/Seoul' date -d '+7 days' '+%Y-%m-%d')
        target_day=$(TZ='Asia/Seoul' date -d '+7 days' '+%u') # 1=월요일, 7=일요일
        day_name_en=$(TZ='Asia/Seoul' date -d '+7 days' '+%A')
        
        # 한국어 요일 변환
        case $day_name_en in
          "Monday") day_name="월요일" ;;
          "Tuesday") day_name="화요일" ;;
          "Wednesday") day_name="수요일" ;;
          "Thursday") day_name="목요일" ;;
          "Friday") day_name="금요일" ;;
          "Saturday") day_name="토요일" ;;
          "Sunday") day_name="일요일" ;;
          *) day_name=$day_name_en ;;
        esac
        
        echo "🎯 예약 대상 날짜: $target_date ($day_name)"
        echo "📊
